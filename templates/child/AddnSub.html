<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Adventure üßÆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #a1c4fd, #c2e9fb);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 800px;
            padding: 30px;
            text-align: center;
        }

        h1 {
            color: #5d6afb;
            margin-bottom: 20px;
            font-size: 2.5rem;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.2rem;
        }

        .game-area {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .question-section, .working-section, .answers-section {
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .question-section {
            background-color: #e6f7ff;
            border: 3px dashed #5d6afb;
        }

        .question {
            font-size: 2.5rem;
            margin: 10px 0;
            color: #333;
        }

        .placeholder {
            display: inline-block;
            width: 80px;
            height: 60px;
            background-color: white;
            border: 2px solid #5d6afb;
            border-radius: 10px;
            margin: 0 10px;
            vertical-align: middle;
        }

        .answers-section {
            background-color: #f0f9ff;
        }

        .answers-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .answer-btn {
            padding: 15px;
            font-size: 1.5rem;
            background-color: #5d6afb;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .answer-btn:hover {
            background-color: #4a57d8;
            transform: translateY(-3px);
        }

        .working-section {
            background-color: #fff9e6;
            border: 2px solid #ffcc00;
        }

        .counter-display {
            font-size: 2rem;
            margin: 15px 0;
            color: #333;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .control-btn {
            padding: 15px 25px;
            font-size: 1.5rem;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s;
            width: 70px;
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-btn {
            background-color: #4CAF50;
            color: white;
        }

        .subtract-btn {
            background-color: #f44336;
            color: white;
        }

        .reset-btn {
            background-color: #ff9800;
            color: white;
            border-radius: 10px;
            width: auto;
            padding: 10px 20px;
            font-size: 1.2rem;
        }

        .circles-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            min-height: 80px;
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 10px;
            border: 2px dashed #ccc;
        }

        .circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #5d6afb;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            animation: pop 0.3s ease-out;
        }

        @keyframes pop {
            0% { transform: scale(0); }
            70% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .hint {
            font-size: 1rem;
            color: #666;
            margin-top: 10px;
        }

        .progress {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
        }

        .rounds-selector {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        select {
            padding: 8px 15px;
            border-radius: 8px;
            border: 2px solid #5d6afb;
            font-size: 1rem;
        }

        .feedback-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }

        .feedback-content {
            background-color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            transform: scale(0.8);
            transition: transform 0.5s;
        }

        .feedback-screen.show {
            opacity: 1;
            pointer-events: all;
        }

        .feedback-screen.show .feedback-content {
            transform: scale(1);
        }

        .win-screen .feedback-content {
            background: linear-gradient(135deg, #a8ff78, #78ffd6);
        }

        .fail-screen .feedback-content {
            background: linear-gradient(135deg, #ff9a9e, #fad0c4);
        }

        .congrats-screen .feedback-content {
            background: linear-gradient(135deg, #ffecd2, #fcb69f);
        }

        .feedback-emoji {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .feedback-message {
            font-size: 2rem;
            margin-bottom: 30px;
            color: #333;
        }

        .feedback-btn {
            padding: 12px 30px;
            font-size: 1.2rem;
            background-color: #5d6afb;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .feedback-btn:hover {
            background-color: #4a57d8;
            transform: translateY(-3px);
        }

        @media (max-width: 600px) {
            .question {
                font-size: 1.8rem;
            }
            
            .answers-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Math Adventure üßÆ</h1>
        <p class="subtitle">Learn addition and subtraction with fun counters!</p>
        
        <div class="game-area">
            <div class="question-section">
                <h2>Solve the problem:</h2>
                <div class="question" id="question">2 + 1 = <span class="placeholder"></span></div>
            </div>
            
            <div class="answers-section">
                <h2>Select your answer:</h2>
                <div class="answers-grid" id="answers-grid">
                    <!-- Answer buttons will be added here dynamically -->
                </div>
            </div>
            
            <div class="working-section">
                <h2>Working Area üõ†Ô∏è</h2>
                <div class="counter-display">Count: <span id="counter">0</span></div>
                
                <div class="controls">
                    <button class="control-btn add-btn" id="add-btn">‚ûï</button>
                    <button class="control-btn subtract-btn" id="subtract-btn">‚ûñ</button>
                    <button class="reset-btn" id="reset-btn">Reset üîÑ</button>
                </div>
                
                <div class="circles-container" id="circles-container">
                    <!-- Circles will be added here dynamically -->
                </div>
                
                <p class="hint" id="hint">Tap ‚ûï to add counters, ‚ûñ to remove</p>
            </div>
            
            <div class="progress">
                <div>Round: <span id="current-round">1</span>/<span id="total-rounds">10</span></div>
                <div class="rounds-selector">
                    <label for="rounds-select">Rounds:</label>
                    <select id="rounds-select">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Feedback Screens -->
    <div class="feedback-screen win-screen" id="win-screen">
        <div class="feedback-content">
            <div class="feedback-emoji">‚úÖ</div>
            <div class="feedback-message">Correct! üéâ</div>
        </div>
    </div>
    
    <div class="feedback-screen fail-screen" id="fail-screen">
        <div class="feedback-content">
            <div class="feedback-emoji">‚ùå</div>
            <div class="feedback-message">Try Again! ü§î</div>
            <button class="feedback-btn" id="retry-btn">Retry</button>
        </div>
    </div>
    
    <div class="feedback-screen congrats-screen" id="congrats-screen">
        <div class="feedback-content">
            <div class="feedback-emoji">üèÜ</div>
            <div class="feedback-message">Congratulations! üéä</div>
            <p>You completed all rounds!</p>
            <button class="feedback-btn" id="replay-btn">Play Again</button>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            currentRound: 1,
            totalRounds: 10,
            currentProblem: null,
            correctAnswer: null,
            counter: 0,
            circles: []
        };

        // DOM elements
        const questionElement = document.getElementById('question');
        const counterElement = document.getElementById('counter');
        const circlesContainer = document.getElementById('circles-container');
        const hintElement = document.getElementById('hint');
        const answersGrid = document.getElementById('answers-grid');
        const addButton = document.getElementById('add-btn');
        const subtractButton = document.getElementById('subtract-btn');
        const resetButton = document.getElementById('reset-btn');
        const currentRoundElement = document.getElementById('current-round');
        const totalRoundsElement = document.getElementById('total-rounds');
        const roundsSelect = document.getElementById('rounds-select');
        const winScreen = document.getElementById('win-screen');
        const failScreen = document.getElementById('fail-screen');
        const congratsScreen = document.getElementById('congrats-screen');
        const retryButton = document.getElementById('retry-btn');
        const replayButton = document.getElementById('replay-btn');

        // Initialize game
        function initGame() {
            gameState.currentRound = 1;
            gameState.totalRounds = parseInt(roundsSelect.value);
            updateRoundDisplay();
            resetWorkingArea();
            generateProblem();
            setupEventListeners();
        }

        // Set up event listeners
        function setupEventListeners() {
            addButton.addEventListener('click', addCircle);
            subtractButton.addEventListener('click', removeCircle);
            resetButton.addEventListener('click', resetWorkingArea);
            roundsSelect.addEventListener('change', updateTotalRounds);
            retryButton.addEventListener('click', hideFailScreen);
            replayButton.addEventListener('click', replayGame);
        }

        // Generate a new math problem
        function generateProblem() {
            // Randomly choose between addition and subtraction
            const isAddition = Math.random() > 0.5;
            
            if (isAddition) {
                // For addition: a + b = ?
                const a = Math.floor(Math.random() * 10) + 1; // 1-10
                const b = Math.floor(Math.random() * 10) + 1; // 1-10
                gameState.currentProblem = { a, b, operation: '+' };
                gameState.correctAnswer = a + b;
            } else {
                // For subtraction: a - b = ?, ensuring non-negative result
                const a = Math.floor(Math.random() * 10) + 1; // 1-10
                const b = Math.floor(Math.random() * a) + 1; // 1-a to ensure non-negative
                gameState.currentProblem = { a, b, operation: '-' };
                gameState.correctAnswer = a - b;
            }
            
            displayProblem();
            generateAnswerOptions();
        }

        // Display the current problem
        function displayProblem() {
            const { a, b, operation } = gameState.currentProblem;
            questionElement.innerHTML = `${a} ${operation} ${b} = <span class="placeholder"></span>`;
        }

        // Generate answer options (one correct, two incorrect)
        function generateAnswerOptions() {
            answersGrid.innerHTML = '';
            
            // Create incorrect answers that are close to the correct one
            const answers = [gameState.correctAnswer];
            
            // Generate two distinct wrong answers
            while (answers.length < 3) {
                let wrongAnswer;
                // Ensure wrong answers are different and positive
                do {
                    const offset = Math.floor(Math.random() * 5) + 1; // 1-5
                    const sign = Math.random() > 0.5 ? 1 : -1;
                    wrongAnswer = gameState.correctAnswer + (sign * offset);
                } while (answers.includes(wrongAnswer) || wrongAnswer < 0);
                
                answers.push(wrongAnswer);
            }
            
            // Shuffle the answers
            shuffleArray(answers);
            
            // Create answer buttons
            answers.forEach(answer => {
                const button = document.createElement('button');
                button.className = 'answer-btn';
                button.textContent = answer;
                button.addEventListener('click', () => checkAnswer(answer));
                answersGrid.appendChild(button);
            });
        }

        // Check if the selected answer is correct
        function checkAnswer(selectedAnswer) {
            if (selectedAnswer === gameState.correctAnswer) {
                showWinScreen();
                setTimeout(() => {
                    hideWinScreen();
                    nextRound();
                }, 1000);
            } else {
                showFailScreen();
            }
        }

        // Move to the next round
        function nextRound() {
            gameState.currentRound++;
            updateRoundDisplay();
            
            if (gameState.currentRound > gameState.totalRounds) {
                showCongratsScreen();
            } else {
                resetWorkingArea();
                generateProblem();
            }
        }

        // Add a circle to the working area
        function addCircle() {
            gameState.counter++;
            updateCounter();
            
            const circle = document.createElement('div');
            circle.className = 'circle';
            circle.textContent = gameState.counter;
            circlesContainer.appendChild(circle);
            gameState.circles.push(circle);
            
            updateHint();
        }

        // Remove a circle from the working area
        function removeCircle() {
            if (gameState.counter > 0) {
                gameState.counter--;
                updateCounter();
                
                const circle = gameState.circles.pop();
                if (circle) {
                    circle.remove();
                }
                
                updateHint();
            }
        }

        // Reset the working area
        function resetWorkingArea() {
            gameState.counter = 0;
            gameState.circles = [];
            updateCounter();
            circlesContainer.innerHTML = '';
            updateHint();
        }

        // Update the counter display
        function updateCounter() {
            counterElement.textContent = gameState.counter;
        }

        // Update the hint text
        function updateHint() {
            if (gameState.counter === 0) {
                hintElement.textContent = "Tap ‚ûï to add counters";
            } else {
                hintElement.textContent = `You have ${gameState.counter} counter${gameState.counter !== 1 ? 's' : ''}. Tap ‚ûï to add more or ‚ûñ to remove`;
            }
        }

        // Update the round display
        function updateRoundDisplay() {
            currentRoundElement.textContent = gameState.currentRound;
            totalRoundsElement.textContent = gameState.totalRounds;
        }

        // Update total rounds when selector changes
        function updateTotalRounds() {
            gameState.totalRounds = parseInt(roundsSelect.value);
            updateRoundDisplay();
        }

        // Show/hide feedback screens
        function showWinScreen() {
            winScreen.classList.add('show');
        }

        function hideWinScreen() {
            winScreen.classList.remove('show');
        }

        function showFailScreen() {
            failScreen.classList.add('show');
        }

        function hideFailScreen() {
            failScreen.classList.remove('show');
        }

        function showCongratsScreen() {
            congratsScreen.classList.add('show');
        }

        function hideCongratsScreen() {
            congratsScreen.classList.remove('show');
        }

        // Replay the game
        function replayGame() {
            hideCongratsScreen();
            initGame();
        }

        // Utility function to shuffle an array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Start the game
        initGame();
    </script>
</body>
</html>