<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Library</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #4cc9f0;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --dark: #212529;
            --light: #f8f9fa;
            --sidebar-width: 300px;
            --border-radius: 8px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: white;
            border-bottom: 1px solid #e1e5eb;
            display: flex;
            align-items: center;
            padding: 0 1rem;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .menu-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            transition: var(--transition);
        }

        .menu-btn:hover {
            background: #f0f0f0;
        }

        .app-title {
            margin-left: 1rem;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary);
        }

        /* Sidebar/Drawer */
        .sidebar {
            position: fixed;
            top: 60px;
            left: 0;
            bottom: 0;
            width: var(--sidebar-width);
            background: white;
            border-right: 1px solid #e1e5eb;
            display: flex;
            flex-direction: column;
            transition: var(--transition);
            transform: translateX(-100%);
            z-index: 90;
            box-shadow: var(--shadow);
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .sidebar-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .sidebar-subtitle {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .search-container {
            padding: 1rem;
            border-bottom: 1px solid #e1e5eb;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
        }

        .categories {
            flex: 1;
            overflow-y: auto;
            padding: 1rem 0;
        }

        .category {
            margin-bottom: 1.5rem;
        }

        .category-title {
            padding: 0.5rem 1rem;
            font-weight: 600;
            color: var(--primary);
            border-bottom: 1px solid #e9ecef;
            margin-bottom: 0.5rem;
        }

        .topic-list {
            list-style: none;
        }

        .topic-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: var(--transition);
            border-left: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .topic-item:hover {
            background: #f8f9fa;
        }

        .topic-item.active {
            background: #eef2ff;
            border-left-color: var(--primary);
            color: var(--primary);
            font-weight: 600;
        }

        .topic-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #e9ecef;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .topic-item.active .topic-icon {
            background: var(--primary);
            color: white;
        }

        .sidebar-footer {
            padding: 1rem;
            border-top: 1px solid #e1e5eb;
            display: flex;
            gap: 0.5rem;
        }

        .sidebar-btn {
            flex: 1;
            padding: 0.75rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .sidebar-btn:hover {
            background: #3a56e4;
        }

        .sidebar-btn.export {
            background: var(--success);
        }

        .sidebar-btn.export:hover {
            background: #27ae60;
        }

        /* Main Content */
        .main-content {
            margin-top: 60px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 60px);
        }

        .demo-area {
            background: white;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 800px;
            margin-bottom: 2rem;
        }

        .demo-title {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--dark);
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 0.5rem;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: var(--transition);
            z-index: 1000;
        }

        .fab:hover {
            background: #3a56e4;
            transform: translateY(-3px);
            box-shadow: 0 6px 14px rgba(0, 0, 0, 0.25);
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 1rem;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            padding: 1.5rem;
            background: var(--dark);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .close-btn {
            background: transparent;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: var(--transition);
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .modal-body {
            flex: 1;
            padding: 1.5rem;
            overflow: auto;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: var(--border-radius);
            padding: 1.5rem;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            line-height: 1.5;
            max-height: 400px;
            overflow: auto;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            background: white;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .btn:hover {
            background: #f8f9fa;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .btn-primary:hover {
            background: #3a56e4;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: #6c757d;
        }

        .empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-title {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
            }

            .fab {
                bottom: 1rem;
                right: 1rem;
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <button class="menu-btn" id="menu-btn">â˜°</button>
        <h1 class="app-title">Code Library</h1>
    </div>

    <!-- Sidebar/Drawer -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h1 class="sidebar-title">Code Library</h1>
            <p class="sidebar-subtitle">Your personal collection of code features</p>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="Search features...">
        </div>

        <div class="categories" id="categories">
            <!-- Categories and topics will be populated by JavaScript -->
        </div>

        <div class="sidebar-footer">
            <button class="sidebar-btn" id="import-btn">Import</button>
            <button class="sidebar-btn export" id="export-btn">Export</button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="demo-area" id="demo-area">
            <!-- Demo content will be populated by JavaScript -->
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" id="code-fab">
        <span>{"</>"}</span>
    </button>

    <!-- Code Modal -->
    <div class="modal hidden" id="code-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Code</h2>
                <button class="close-btn" id="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <pre class="code-block" id="code-block"></pre>
            </div>
            <div class="modal-footer">
                <button class="btn" id="copy-code">Copy Code</button>
                <button class="btn btn-primary" id="close-code-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div class="modal hidden" id="import-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Import Library Data</h2>
                <button class="close-btn" id="close-import-modal">&times;</button>
            </div>
            <div class="modal-body">
                <textarea id="import-data" placeholder="Paste your library data here..." style="width: 100%; height: 300px; padding: 1rem; border: 1px solid #ddd; border-radius: var(--border-radius); font-family: monospace;"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn" id="cancel-import">Cancel</button>
                <button class="btn btn-primary" id="confirm-import">Import</button>
            </div>
        </div>
    </div>

    <script>
        // Simple library data structure
        const libraryData = {
            "Flexbox Layout": `<div class="flex-container">
  <div class="flex-item">Item 1</div>
  <div class="flex-item">Item 2</div>
  <div class="flex-item">Item 3</div>
</div>

<style>
.flex-container {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  padding: 1rem;
  background: #f8f9fa;
  border-radius: 8px;
}

.flex-item {
  flex: 1;
  min-width: 100px;
  padding: 1rem;
  background: #4361ee;
  color: white;
  border-radius: 4px;
  text-align: center;
}
</style>

<script>
// JavaScript for interactive flexbox example
const container = document.querySelector('.flex-container');
const items = document.querySelectorAll('.flex-item');

items.forEach((item, index) => {
  item.addEventListener('click', () => {
    alert(\`You clicked item \${index + 1}\`);
  });
});
<\/script>`,

            "CSS Grid": `<div class="grid-container">
  <div class="grid-item header">Header</div>
  <div class="grid-item sidebar">Sidebar</div>
  <div class="grid-item main">Main Content</div>
  <div class="grid-item footer">Footer</div>
</div>

<style>
.grid-container {
  display: grid;
  grid-template-columns: 1fr 3fr;
  grid-template-rows: auto 1fr auto;
  grid-template-areas:
    "header header"
    "sidebar main"
    "footer footer";
  gap: 10px;
  height: 300px;
}

.header { grid-area: header; background: #4361ee; }
.sidebar { grid-area: sidebar; background: #3a0ca3; }
.main { grid-area: main; background: #4cc9f0; }
.footer { grid-area: footer; background: #7209b7; }

.grid-item {
  padding: 1rem;
  color: white;
  border-radius: 4px;
}
</style>

<script>
// JavaScript for grid layout example
const gridItems = document.querySelectorAll('.grid-item');

gridItems.forEach(item => {
  item.addEventListener('mouseenter', () => {
    item.style.opacity = '0.9';
    item.style.transform = 'scale(1.02)';
  });
  
  item.addEventListener('mouseleave', () => {
    item.style.opacity = '1';
    item.style.transform = 'scale(1)';
  });
});
<\/script>`,

            "Modal Dialog": `<button id="open-modal">Open Modal</button>

<div class="modal" id="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Modal Title</h2>
      <button class="close-modal">&times;</button>
    </div>
    <div class="modal-body">
      <p>This is a modal dialog example.</p>
    </div>
    <div class="modal-footer">
      <button class="btn">Cancel</button>
      <button class="btn btn-primary">Save</button>
    </div>
  </div>
</div>

<style>
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.5);
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: white;
  border-radius: 8px;
  width: 90%;
  max-width: 500px;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.modal-header {
  padding: 1rem 1.5rem;
  background: #212529;
  color: white;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-radius: 8px 8px 0 0;
}

.modal-body {
  padding: 1.5rem;
}

.modal-footer {
  padding: 1rem 1.5rem;
  background: #f8f9fa;
  border-top: 1px solid #dee2e6;
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  border-radius: 0 0 8px 8px;
}

.btn {
  padding: 0.5rem 1rem;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  cursor: pointer;
}

.btn-primary {
  background: #4361ee;
  color: white;
  border-color: #4361ee;
}
</style>

<script>
const openModalBtn = document.getElementById('open-modal');
const modal = document.getElementById('modal');
const closeModalBtn = document.querySelector('.close-modal');

openModalBtn.addEventListener('click', () => {
  modal.style.display = 'flex';
});

closeModalBtn.addEventListener('click', () => {
  modal.style.display = 'none';
});

modal.addEventListener('click', (e) => {
  if (e.target === modal) {
    modal.style.display = 'none';
  }
});
<\/script>`
        };

        // DOM Elements
        const menuBtn = document.getElementById('menu-btn');
        const sidebar = document.getElementById('sidebar');
        const categoriesContainer = document.getElementById('categories');
        const demoArea = document.getElementById('demo-area');
        const codeFab = document.getElementById('code-fab');
        const codeModal = document.getElementById('code-modal');
        const closeModal = document.getElementById('close-modal');
        const modalTitle = document.getElementById('modal-title');
        const codeBlock = document.getElementById('code-block');
        const copyCodeBtn = document.getElementById('copy-code');
        const closeCodeBtn = document.getElementById('close-code-btn');
        const importBtn = document.getElementById('import-btn');
        const exportBtn = document.getElementById('export-btn');
        const importModal = document.getElementById('import-modal');
        const closeImportModal = document.getElementById('close-import-modal');
        const cancelImport = document.getElementById('cancel-import');
        const confirmImport = document.getElementById('confirm-import');
        const importData = document.getElementById('import-data');

        // Current active topic
        let currentTopic = Object.keys(libraryData)[0] || null;

        // Initialize the app
        function initApp() {
            // Load library data from localStorage if available
            const savedData = localStorage.getItem('codeLibrary');
            if (savedData) {
                try {
                    const parsedData = JSON.parse(savedData);
                    Object.assign(libraryData, parsedData);
                } catch (e) {
                    console.error('Error loading saved data:', e);
                }
            }
            
            // Populate categories and topics
            populateCategories();
            
            // Set the first topic as active
            if (currentTopic) {
                updateContent(currentTopic);
            } else {
                showEmptyState();
            }
            
            // Add event listeners
            addEventListeners();
        }

        // Populate categories and topics
        function populateCategories() {
            // Clear existing content
            categoriesContainer.innerHTML = '';
            
            // Create a single category for all topics
            const categoryDiv = document.createElement('div');
            categoryDiv.className = 'category';
            
            const categoryTitle = document.createElement('h3');
            categoryTitle.className = 'category-title';
            categoryTitle.textContent = 'All Topics';
            categoryDiv.appendChild(categoryTitle);
            
            const topicList = document.createElement('ul');
            topicList.className = 'topic-list';
            
            // Add each topic to the list
            Object.keys(libraryData).forEach(topicName => {
                const topicItem = document.createElement('li');
                topicItem.className = 'topic-item';
                if (topicName === currentTopic) {
                    topicItem.classList.add('active');
                }
                topicItem.setAttribute('data-topic', topicName);
                
                const topicIcon = document.createElement('span');
                topicIcon.className = 'topic-icon';
                topicIcon.textContent = topicName.charAt(0);
                
                const topicText = document.createElement('span');
                topicText.textContent = topicName;
                
                topicItem.appendChild(topicIcon);
                topicItem.appendChild(topicText);
                
                topicList.appendChild(topicItem);
            });
            
            categoryDiv.appendChild(topicList);
            categoriesContainer.appendChild(categoryDiv);
            
            // Add event listeners to topic items
            const topicItems = document.querySelectorAll('.topic-item');
            topicItems.forEach(item => {
                item.addEventListener('click', () => {
                    // Update active state
                    topicItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Update content
                    currentTopic = item.getAttribute('data-topic');
                    updateContent(currentTopic);
                    
                    // Close sidebar on mobile
                    if (window.innerWidth <= 768) {
                        sidebar.classList.remove('open');
                    }
                });
            });
        }

        // Update the main content based on selected topic
        function updateContent(topicName) {
            const topicCode = libraryData[topicName];
            
            if (!topicCode) {
                showEmptyState();
                return;
            }
            
            // Extract HTML from the code (everything before the first <style> tag)
            const htmlMatch = topicCode.match(/^(.*?)(?=<style|$)/s);
            const htmlContent = htmlMatch ? htmlMatch[1].trim() : '';
            
            // Create demo content
            demoArea.innerHTML = `
                <h3 class="demo-title">${topicName}</h3>
                <div id="demo-content">${htmlContent}</div>
            `;
            
            // Execute any JavaScript in the demo
            try {
                // Extract and execute JS (everything between <script> tags)
                const jsMatches = topicCode.match(/<script>([\s\S]*?)<\/script>/g);
                if (jsMatches) {
                    jsMatches.forEach(scriptTag => {
                        const jsCode = scriptTag.replace(/<\/?script>/g, '');
                        // Create a function and execute the code
                        const executeCode = new Function(jsCode);
                        executeCode();
                    });
                }
            } catch (e) {
                console.error('Error executing demo JavaScript:', e);
            }
        }

        // Show empty state when no topics available
        function showEmptyState() {
            demoArea.innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">ðŸ“š</div>
                    <h3 class="empty-title">No Code Examples</h3>
                    <p>Add some code examples to your library to get started.</p>
                </div>
            `;
        }

        // Show code modal with the current topic's code
        function showCodeModal() {
            if (!currentTopic) return;
            
            const topicCode = libraryData[currentTopic];
            
            if (!topicCode) return;
            
            // Update modal title and code content
            modalTitle.textContent = `${currentTopic} - Code`;
            codeBlock.textContent = topicCode;
            
            // Show modal
            codeModal.classList.remove('hidden');
        }

        // Export library data
        function exportLibrary() {
            const dataStr = JSON.stringify(libraryData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'code-library.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            // Close sidebar on mobile
            if (window.innerWidth <= 768) {
                sidebar.classList.remove('open');
            }
        }

        // Import library data
        function importLibrary() {
            importModal.classList.remove('hidden');
        }

        // Confirm import
        function confirmImportLibrary() {
            const data = importData.value.trim();
            
            if (!data) {
                alert('Please paste library data to import.');
                return;
            }
            
            try {
                const parsedData = JSON.parse(data);
                
                // Validate the data structure
                if (typeof parsedData !== 'object' || Array.isArray(parsedData)) {
                    throw new Error('Invalid data format. Expected an object.');
                }
                
                // Clear existing data and merge with imported data
                Object.keys(libraryData).forEach(key => {
                    delete libraryData[key];
                });
                
                Object.assign(libraryData, parsedData);
                
                // Save to localStorage
                localStorage.setItem('codeLibrary', JSON.stringify(libraryData));
                
                // Update UI
                populateCategories();
                
                // Set first topic as active if available
                const topics = Object.keys(libraryData);
                if (topics.length > 0) {
                    currentTopic = topics[0];
                    updateContent(currentTopic);
                } else {
                    showEmptyState();
                }
                
                // Close modals
                importModal.classList.add('hidden');
                sidebar.classList.remove('open');
                
                alert('Library data imported successfully!');
            } catch (e) {
                alert('Error importing data: ' + e.message);
            }
        }

        // Add all event listeners
        function addEventListeners() {
            // Menu button toggles sidebar
            menuBtn.addEventListener('click', () => {
                sidebar.classList.toggle('open');
            });
            
            // Code FAB click
            codeFab.addEventListener('click', showCodeModal);
            
            // Close modals
            closeModal.addEventListener('click', () => {
                codeModal.classList.add('hidden');
            });
            
            closeCodeBtn.addEventListener('click', () => {
                codeModal.classList.add('hidden');
            });
            
            closeImportModal.addEventListener('click', () => {
                importModal.classList.add('hidden');
            });
            
            cancelImport.addEventListener('click', () => {
                importModal.classList.add('hidden');
            });
            
            // Copy code button
            copyCodeBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(codeBlock.textContent)
                    .then(() => {
                        alert('Code copied to clipboard!');
                    })
                    .catch(err => {
                        console.error('Failed to copy code: ', err);
                        alert('Failed to copy code. Please try again.');
                    });
            });
            
            // Import/Export buttons
            importBtn.addEventListener('click', importLibrary);
            exportBtn.addEventListener('click', exportLibrary);
            
            // Confirm import
            confirmImport.addEventListener('click', confirmImportLibrary);
            
            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', (e) => {
                if (window.innerWidth <= 768 && 
                    sidebar.classList.contains('open') && 
                    !sidebar.contains(e.target) && 
                    e.target !== menuBtn) {
                    sidebar.classList.remove('open');
                }
            });
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>