<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CodeVault Offline ‚Ä¢ Fixed & Perfect</title>
  <style>
    :root {
      --bg: #fafafa;
      --surface: #ffffff;
      --text: #1e293b;
      --text-muted: #64748b;
      --primary: #4361ee;
      --primary-hover: #3a56e4;
      --border: #e2e8f0;
      --radius: 14px;
      --shadow: 0 10px 30px rgba(0,0,0,0.08);
      --transition: all 0.22s ease;
    }

    [data-theme="dark"] {
      --bg: #0f172a;
      --surface: #1e293b;
      --text: #f1f5f9;
      --text-muted: #94a3b8;
      --border: #334155;
      --shadow: 0 10px 30px rgba(0,0,0,0.4);
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Segoe UI', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      transition: var(--transition);
      min-height: 100vh;
      overflow-x: hidden;
    }

    header {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: 68px;
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      padding: 0 1.5rem;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      gap: 1rem;
    }

    .logo { font-weight: 800; font-size: 1.6rem; color: var(--primary); }
    .menu-btn, .theme-btn {
      font-size: 1.6rem; background:none; border:none; cursor:pointer; padding:8px; border-radius:8px; transition:var(--transition);
    }
    .menu-btn:hover, .theme-btn:hover { background:rgba(67,97,238,0.1); }

    /* Sidebar with close button on mobile */
    .sidebar {
      position:fixed;
      top:0; bottom:0; left:0;
      width:340px;
      background:var(--surface);
      border-right:1px solid var(--border);
      overflow-y:auto;
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: var(--shadow);
      z-index: 1100;
      transform: translateX(0);
    }

    .sidebar-header {
      height: 68px;
      padding: 0 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--surface);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .close-drawer {
      font-size: 1.8rem;
      display: none;
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      border-radius: 6px;
    }

    @media (max-width: 868px) {
      .sidebar { transform: translateX(-100%); }
      .sidebar.open { transform: translateX(0); }
      .close-drawer { display: block; }
      main { margin-left: 0 !important; padding: 1rem; }
    }

    .search {
      padding:1rem;
      border-bottom:1px solid var(--border);
      background: var(--surface);
      position: sticky;
      top: 68px;
      z-index: 9;
    }
    .search input {
      width:100%; padding:0.85rem 1rem;
      border:1px solid var(--border);
      border-radius:10px;
      font-size:1rem;
      background:var(--bg);
      color:var(--text);
      outline:none;
    }
    .search input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(67,97,238,0.15);
    }

    .categories { padding:0.5rem 0; }
    .cat-title {
      padding:0.8rem 1.5rem;
      font-weight:700;
      font-size:0.88rem;
      text-transform:uppercase;
      letter-spacing:0.8px;
      color:var(--primary);
    }
    .topic {
      padding:0.85rem 1.5rem;
      display:flex;
      align-items:center;
      gap:14px;
      cursor:pointer;
      transition:var(--transition);
      border-left:4px solid transparent;
    }
    .topic:hover { background:rgba(67,97,238,0.08); }
    .topic.active {
      background:rgba(67,97,238,0.14);
      border-left-color:var(--primary);
      font-weight:600;
    }
    .topic-icon {
      width:40px; height:40px;
      background:var(--primary);
      color:#fff;
      border-radius:10px;
      display:grid;
      place-items:center;
      font-weight:bold;
      font-size:1rem;
    }

    main {
      margin-left:340px;
      margin-top:68px;
      padding:2.5rem;
      min-height: calc(100vh - 68px);
    }

    .card {
      background:var(--surface);
      border-radius:var(--radius);
      padding:2.5rem;
      max-width:1000px;
      margin:0 auto;
      box-shadow:var(--shadow);
    }
    .title { font-size:2rem; margin-bottom:0.5rem; }
    .desc { color:var(--text-muted); font-size:1.1rem; margin-bottom:2rem; }

    .preview {
      border:1px solid var(--border);
      border-radius:12px;
      overflow:hidden;
      min-height:420px;
      background:#fff;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    }
    .preview iframe { width:100%; height:620px; border:0; }

    .fab {
      position:fixed;
      bottom:30px; right:30px;
      width:68px; height:68px;
      background:var(--primary);
      color:#fff;
      border:none;
      border-radius:50%;
      font-size:2rem;
      cursor:pointer;
      box-shadow:0 10px 30px rgba(67,97,238,0.4);
      transition:var(--transition);
      z-index:999;
    }
    .fab:hover { transform:scale(1.12); background:var(--primary-hover); }
    .fab:disabled { opacity:0.5; cursor:not-allowed; transform:none; }

    .modal {
      position:fixed; inset:0;
      background:rgba(0,0,0,0.85);
      display:grid; place-items:center;
      z-index:2000;
      opacity:0; visibility:hidden;
      transition:var(--transition);
      backdrop-filter: blur(8px);
    }
    .modal.open { opacity:1; visibility:visible; }
    .modal-content {
      background:var(--surface);
      width:94%; max-width:1100px;
      max-height:92vh;
      border-radius:var(--radius);
      overflow:hidden;
      box-shadow:var(--shadow);
      display:flex; flex-direction:column;
    }
    .modal-header {
      padding:1.5rem 2rem;
      background:var(--primary);
      color:#fff;
      display:flex;
      justify-content:space-between;
      align-items:center;
      font-size:1.4rem;
      font-weight:600;
    }
    .close { font-size:2.2rem; background:none; border:none; color:#fff; cursor:pointer; padding:0 4px; border-radius:6px; }
    .close:hover { background: rgba(255,255,255,0.1); }

    .code {
      flex:1;
      overflow:auto;
      padding:2rem;
      background:#1e1e1e;
      color:#d4d4d4;
      font-family:'Consolas','Courier New',monospace;
      font-size:0.98rem;
      line-height:1.7;
      white-space: pre;
    }
    .code .tag { color:#569cd6; }
    .code .attr { color:#9cdcfe; }
    .code .val { color:#ce9178; }
    .code .com { color:#6a9955; font-style:italic; }
    .code .key { color:#c586c0; }

    .modal-footer {
      padding:1rem 2rem;
      background:var(--bg);
      border-top:1px solid var(--border);
      text-align:right;
    }
    .btn {
      padding:0.85rem 2.2rem;
      background:#10b981;
      color:#fff;
      border:none;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      font-size:1rem;
    }
    .btn:hover { background:#059669; }
  </style>
</head>
<body>

<header>
  <button class="menu-btn" id="menuBtn">‚ò∞</button>
  <div class="logo">CodeVault</div>
  <div style="flex:1"></div>
  <button class="theme-btn" id="themeBtn">üåô</button>
</header>

<aside class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div style="font-weight:600; font-size:1.1rem;">Snippets</div>
    <button class="close-drawer" id="closeDrawer">&times;</button>
  </div>
  <div class="search"><input type="text" id="search" placeholder="Search snippets‚Ä¶ (Ctrl+K)" /></div>
  <div class="categories" id="cats"></div>
</aside>

<main>
  <div class="card" id="demo">
    <div style="text-align:center;padding:5rem 2rem;color:var(--text-muted);">
      <div style="font-size:5rem;margin-bottom:1.5rem;">‚ö°</div>
      <h2>Select a snippet from the sidebar</h2>
      <p style="margin-top:1rem;">Use Ctrl+K to search ‚Ä¢ Ctrl+Shift+C to view code</p>
    </div>
  </div>
</main>

<button class="fab" id="fab" disabled>‚ö°</button>

<div class="modal" id="modal">
  <div class="modal-content">
    <div class="modal-header">
      <div id="modalTitle">Code</div>
      <button class="close">√ó</button>
    </div>
    <pre class="code" id="codeBlock"><code></code></pre>
    <div class="modal-footer">
      <button class="btn" id="copy">Copy All</button>
    </div>
  </div>
</div>

<script>
  const snippets = {
    "Layout": {
      "Perfect Center": {
        desc: "Center anything with CSS Grid",
        html: `<div class="center">Perfectly Centered</div>`,
        css: `.center{display:grid;place-items:center;height:100vh;margin:0;background:#4361ee;color:#fff;font-size:2.5rem;font-family:system-ui;`,
        js: ""
      },
      "Holy Grail": {
        desc: "Classic header + sidebar + footer layout",
        html: `<div class="holy"><header>Header</header><aside>Sidebar</aside><main>Main</main><footer>Footer</footer></div>`,
        css: `.holy{display:grid;grid-template-rows:auto 1fr auto;grid-template-columns:260px 1fr;min-height:100vh;gap:1rem;padding:1rem;background:#f8fafc;font-family:system-ui}.holy>*{padding:2rem;background:#4361ee;color:#fff;border-radius:12px;text-align:center}@media(max-width:768px){.holy{grid-template-columns:1fr}}`,
        js: ""
      },
      "Responsive Cards": {
        desc: "Auto-fit card grid with hover lift",
        html: `<div class="cards">${Array(6).fill('<div class="card">Card Content</div>').join('')}</div>`,
        css: `.cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:2rem;padding:2rem}.card{background:#fff;padding:2.5rem;border-radius:16px;box-shadow:0 8px 25px rgba(0,0,0,0.1);transition:0.3s;text-align:center;font-size:1.2rem}.card:hover{transform:translateY(-12px);box-shadow:0 20px 40px rgba(0,0,0,0.15)}`,
        js: ""
      }
    },
    "Components": {
      "Glassmorphism": {
        desc: "Frosted glass card effect",
        html: `<div class="glass">Glassmorphism<br><small>Beautiful blur effect</small></div>`,
        css: `body{background:linear-gradient(135deg,#667eea,#764ba2);margin:0;display:grid;place-items:center;min-height:100vh}.glass{padding:3rem 2rem;background:rgba(255,255,255,0.15);border-radius:20px;box-shadow:0 8px 32px rgba(0,0,0,0.2);backdrop-filter:blur(16px);-webkit-backdrop-filter:blur(16px);border:1px solid rgba(255,255,255,0.3);color:#fff;text-align:center;font-family:system-ui;font-size:2rem;font-weight:300}`,
        js: ""
      },
      "Neumorphism Button": {
        desc: "Soft UI pressed effect",
        html: `<button class="neuro">Press Me</button>`,
        css: `.neuro{padding:1.5rem 3.5rem;font-size:1.3rem;border:none;border-radius:20px;background:#e0e5ec;box-shadow:12px 12px 24px #bec3c9,-12px -12px 24px #ffffff;cursor:pointer;transition:0.2s;font-weight:600;outline:none}.neuro:active{box-shadow:inset 8px 8px 16px #bec3c9,inset -8px -8px 16px #ffffff}`,
        js: ""
      },
      "Toast Notification": {
        desc: "Click anywhere ‚Üí toast appears",
        html: `<div class="toast" id="toast">Hello from CodeVault! üëã</div>`,
        css: `.toast{position:fixed;bottom:30px;right:30px;padding:1.2rem 2rem;background:#333;color:#fff;border-radius:12px;opacity:0;transform:translateY(100px);transition:0.4s ease;z-index:1000;box-shadow:0 10px 30px rgba(0,0,0,0.3);font-family:system-ui}.toast.show{opacity:1;transform:translateY(0)}`,
        js: `document.body.onclick=()=>{const t=document.getElementById('toast');t.classList.add('show');setTimeout(()=>t.classList.remove('show'),2500)};`
      }
    },
    "JavaScript": {
      "Copy to Clipboard": {
        desc: "Modern Clipboard API",
        html: `<textarea id="txt" style="width:100%;padding:1rem;font-size:1rem;">This text will be copied!</textarea><br><br><button onclick="copy()">Copy Text</button>`,
        css: `button{padding:1rem 2rem;background:#4361ee;color:white;border:none;border-radius:10px;font-size:1.1rem;cursor:pointer}`,
        js: `function copy(){const t=document.getElementById('txt').value;navigator.clipboard.writeText(t).then(()=>alert('Copied!'))}`
      },
      "Dark Mode Toggle": {
        desc: "Persistent with localStorage",
        html: `<button id="toggle" style="padding:1rem 2rem;font-size:1.1rem;">Toggle Theme</button>`,
        css: `button{border:none;border-radius:10px;background:#4361ee;color:#fff;cursor:pointer;padding:1rem 2rem;font-size:1.1rem;}`,
        js: `const b=document.getElementById('toggle');const t=localStorage.getItem('theme')||'light';document.body.dataset.theme=t;b.textContent=t==='dark'?'‚òÄÔ∏è Light Mode':'üåô Dark Mode';b.onclick=()=>{const n=document.body.dataset.theme==='dark'?'light':'dark';document.body.dataset.theme=n;localStorage.setItem('theme',n);b.textContent=n==='dark'?'‚òÄÔ∏è Light Mode':'üåô Dark Mode';}`
      }
    }
  };

  const $ = s => document.querySelector(s);
  const $$ = s => document.querySelectorAll(s);

  let currentSnippet = null;

  // Load saved theme
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) document.body.dataset.theme = savedTheme;
  $('#themeBtn').textContent = document.body.dataset.theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

  // Render sidebar
  const cats = $('#cats');
  const frag = document.createDocumentFragment();
  for (const [cat, items] of Object.entries(snippets)) {
    const section = document.createElement('div');
    section.innerHTML = `<div class="cat-title">${cat}</div>`;
    const list = document.createElement('div');
    for (const [name, data] of Object.entries(items)) {
      const topic = document.createElement('div');
      topic.className = 'topic';
      topic.dataset.cat = cat;
      topic.dataset.name = name;
      topic.innerHTML = `
        <span class="topic-icon">${name[0]}</span>
        <div>
          <div style="font-weight:600">${name}</div>
          <small style="color:var(--text-muted);font-size:0.88rem;">${data.desc}</small>
        </div>
      `;
      topic.onclick = () => {
        $$('.topic').forEach(t => t.classList.remove('active'));
        topic.classList.add('active');
        loadSnippet(cat, name, data);
        $('#sidebar').classList.remove('open'); // auto-close on mobile
      };
      list.appendChild(topic);
    }
    section.appendChild(list);
    frag.appendChild(section);
  }
  cats.appendChild(frag);

  // Load snippet into iframe
  function loadSnippet(cat, name, data) {
    currentSnippet = data;
    $('#demo').innerHTML = `
      <h2 class="title">${name}</h2>
      <p class="desc">${data.desc}</p>
      <div class="preview"><iframe sandbox="allow-scripts allow-modals"></iframe></div>
    `;
    const iframe = $('#demo iframe');
    const doc = iframe.contentDocument;
    doc.open();
    doc.write(`
      <!DOCTYPE html>
      <html><head>
        <meta charset="utf-8">
        <style>${data.css || ''}</style>
      </head>
      <body style="margin:0;">
        ${data.html || ''}
        <script>${data.js || ''}<\/script>
      </body></html>
    `);
    doc.close();

    // Enable FAB button
    $('#fab').disabled = false;
  }

  // Show code modal
  $('#fab').onclick = () => {
    if (!currentSnippet) return;
    const code = $('#codeBlock code');
    let full = '';
    if (currentSnippet.html) full += `<!-- HTML -->\n${currentSnippet.html.trim()}\n\n`;
    if (currentSnippet.css) full += `/* CSS */\n${currentSnippet.css.trim()}\n\n`;
    if (currentSnippet.js) full += `// JavaScript\n${currentSnippet.js.trim()}`;
    code.innerHTML = full.trim()
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;')
      .replace(/&(?!#[0-9]+;)/g, '&amp;')
      .replace(/<span class="tag">/g, '<span class="tag">')
      .replace(/(\.[\w-]+|:[\w-]+\([^)]*\)|[\w-]+\s*\{)/g, '<span class="key">$1</span>')
      .replace(/(".*?")|('.*?')/g, '<span class="val">$1$2</span>')
      .replace(/(&lt;!--.*?--&gt;)/g, '<span class="com">$1</span>');
    $('#modalTitle').textContent = currentSnippet.name || 'Code';
    $('#modal').classList.add('open');
  };

  // Copy button
  $('#copy').onclick = () => {
    navigator.clipboard.writeText($('#codeBlock code').textContent).then(() => {
      $('#copy').textContent = 'Copied!';
      setTimeout(() => $('#copy').textContent = 'Copy All', 2000);
    });
  };

  // Controls
  $('#menuBtn').onclick = () => $('#sidebar').classList.add('open');
  $('#closeDrawer').onclick = () => $('#sidebar').classList.remove('open');
  $('.close').onclick = () => $('#modal').classList.remove('open');
  $('#modal').onclick = e => e.target === $('#modal') && $('#modal').classList.remove('open');

  $('#themeBtn').onclick = () => {
    const isDark = document.body.dataset.theme === 'dark';
    document.body.dataset.theme = isDark ? 'light' : 'dark';
    localStorage.setItem('theme', document.body.dataset.theme);
    $('#themeBtn').textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
  };

  // Search
  $('#search').oninput = e => {
    const term = e.target.value.toLowerCase();
    $$('.topic').forEach(t => {
      const text = t.textContent.toLowerCase();
      t.style.display = text.includes(term) ? '' : 'none';
    });
  };

  // Click outside sidebar to close (mobile)
  document.addEventListener('click', e => {
    if (window.innerWidth <= 868 && $('#sidebar').classList.contains('open')) {
      if (!e.target.closest('.sidebar') && !e.target.closest('#menuBtn')) {
        $('#sidebar').classList.remove('open');
      }
    }
  });

  // Keyboard shortcuts
  document.onkeydown = e => {
    if (e.ctrlKey || e.metaKey) {
      if (e.key === 'k') {
        e.preventDefault();
        $('#search').focus();
      $('#search').select();
      }
      if (e.shiftKey && e.key === 'C') {
        e.preventDefault();
        if (!currentSnippet) return;
        $('#fab').click();
      }
    }
    if (e.key === 'Escape') {
      $('#modal').classList.remove('open');
      $('#sidebar').classList.remove('open');
    }
  };

  // Auto-select first topic
  setTimeout(() => {
    const first = $('.topic');
    if (first) first.click();
  }, 100);

  console.log("CodeVault Fixed Edition Ready ‚ö° | Ctrl+K ‚Üí Search | Ctrl+Shift+C ‚Üí Code | Esc ‚Üí Close");
</script>
</body>
</html>